<!DOCTYPE html>
<html lang="es">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Consumo de gasolina</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.css">
	<link rel="stylesheet" href="assets/jquerystyle.css">
	<script defer src="https://use.fontawesome.com/releases/v5.12.1/js/all.js"></script>
</head>

<style>
	body {
		background: #dedede url('https://www.transparenttextures.com/patterns/asfalt-dark.png');
	}

	button {
		margin: 5px 0 0 0;
	}

	.box {
		border-radius: 10px;
		border: 1px solid #dedede;
		padding: 10px;
		box-shadow: 0 0 20px 0;
		margin: 0 5px 10px 5px;
	}

	.form-control:focus {
		border-color: #dedede;
		box-shadow: 0 0 0 0;
	}

	#kml-info:hover {
		background-color: var(--col-jq);
		cursor: pointer;
	}
</style>

<body>
	<nav class="navbar navbar-white bg-jq navbar-expand-md">
		<div class="container">
			<a href="../index.html" class="navbar-brand">
				<img src="../pagpersonal/assets/img/navbar/benny.png" alt="Benny" title="Volver a la pagina principal"
					class="benny-logo">
			</a>
			<span class="navbar-text">Calcular consumo de gasolina</span>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
				aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
				<i class="fas fa-bars fa-sm"></i>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item">
						<a href="lista.html" class="nav-link">Lista</a>
					</li>
					<li class="nav-item">
						<a href="ajax.html" class="nav-link">AJAX</a>
					</li>
					<li class="nav-item">
						<a href="datatable.html" class="nav-link">DataTables</a>
					</li>
					<li class="nav-item">
						<a href="crudjs.html" class="nav-link">CRUD</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<section class="container py-3">

		<div id="moneda" class="row justify-content-center text-center" style="display: none;">
			<div class="col-auto">
				<div class="box">
					<h5>Dolares a Pesos mexicanos</h5>
					<div class="row">
						<div class="col">
							<div class="input-group input-group-sm">
								<div class="input-group-prepend">
									<span class="input-group-text">$</span>
								</div>
								<input id="moneda_de" type="number" class="form-control" placeholder="Dolares" min="0" disabled>
								<div class="input-group-append">
									<span class="input-group-text">USD</span>
								</div>
							</div>
						</div>
						<div class="col">
							<div class="input-group input-group-sm">
								<div class="input-group-prepend">
									<span class="input-group-text">$</span>
								</div>
								<input id="moneda_a" type="number" class="form-control" placeholder="Pesos" min="0" disabled>
								<div class="input-group-append">
									<span class="input-group-text">MXN</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div id="millas-km" class="row justify-content-center text-center">
			<div class="col-auto">
				<div class="box">
					<h5>Millas a Kilometros</h5>
					<div class="row">
						<div class="col">
							<div class="input-group input-group-sm">
								<input id="millas" type="number" class="form-control" placeholder="Millas" min="0">
								<div class="input-group-append">
									<span class="input-group-text">M</span>
								</div>
							</div>
						</div>
						<div class="col">
							<div class="input-group input-group-sm">
								<input id="kilometros" type="number" class="form-control" placeholder="Kilometros" min="0">
								<div class="input-group-append">
									<span class="input-group-text">Km</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div id="galones-l" class="row justify-content-center text-center">
			<div class="col-auto">
				<div class="box">
					<h5>Galones americanos a Litros</h5>
					<div class="row">
						<div class="col">
							<div class="input-group input-group-sm">
								<input id="galones" type="number" class="form-control" placeholder="Galones" min="0">
								<div class="input-group-append">
									<span class="input-group-text">G</span>
								</div>
							</div>
						</div>
						<div class="col">
							<div class="input-group input-group-sm">
								<input id="litros" type="number" class="form-control" placeholder="Litros" min="0">
								<div class="input-group-append">
									<span class="input-group-text">L</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div id="kml-modal" class="modal fade" tabindex="-1">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header bg-jq">
						<h5 class="modal-title">Calcular Km/L de un carro</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<ul class="list-group">
							<li class="list-group-item">Ve a la gasolinera, llena el tanque y luego anota el kilomeraje actual <i>(Kilometraje A)</i>.</li>
							<li class="list-group-item">Conduce normalmente, espera hasta que el tanque este casi vacio y vuelve a llenar el tanque (Mejor si es en la misma gasolinera y la misma bomba que la ultima vez, capaz que las otras esten calibradas diferente).</li>
							<li class="list-group-item">Fijate con cuantos litros se llena el tanque y anotalo <i>(Litros del tanque)</i>.</li>
							<li class="list-group-item">Anota el nuevo kilometraje <i>(Kilometraje B)</i>.</li>
						</ul>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary btn-jq" data-dismiss="modal">Ok</button>
					</div>
				</div>
			</div>
		</div>

		<div id="kml" class="row justify-content-center text-center">
			<div class="col-auto">
				<div class="box">
					<h5>Km/L de un carro <span id="kml-info" class="badge badge-info badge-pill"><i class="fas fa-info-circle"></i></span></h5>
					<label for="kma">Kilometraje A</label>
					<div class="input-group input-group-sm">
						<input id="kma" type="number" class="form-control">
						<div class="input-group-append">
							<span class="input-group-text">Km</span>
						</div>
					</div>
					
					<label for="kmb">Kilometraje B</label>
					<div class="input-group input-group-sm">
						<input id="kmb" type="number" class="form-control">
						<div class="input-group-append">
							<span class="input-group-text">Km</span>
						</div>
					</div>
					
					<label for="litros">Litros del tanque</label>
					<div class="input-group input-group-sm">
						<input id="litros-tanque" type="number" class="form-control">
						<div class="input-group-append">
							<span class="input-group-text">L</span>
						</div>
					</div>
					
					<button id="calc-kml" class="btn btn-success btn-sm">Calcular</button>
					
					<span id="kml-res" style="display: none;"></span>
				</div>
			</div>
		</div>

		<div id="precio-gas-distancia" class="row justify-content-center text-center">
			<div class="col-auto box">
				<h5>Gasto de gasolina para un viaje</h5>
				<label for="distancia">Distancia a recorrer</label>
				<div class="input-group input-group-sm">
					<input id="distancia" type="number" class="form-control">
					<div class="input-group-append">
						<span class="input-group-text">Km</span>
					</div>
				</div>
				<input id="regreso" type="checkbox"> Agregar camino de regreso<br>

				<label for="rendimiento">Rendimiento promedio del vehiculo</label>
				<div class="input-group input-group-sm">
					<input id="rendimiento" type="number" class="form-control">
					<div class="input-group-append">
						<select id="unidad" class="input-group-text">
							<option value="1">L/100Km</option>
							<option value="2">Km/L</option>
						</select>
					</div>
				</div>

				<label for="precio-gas">Precio de la gasolina</label>
				<div class="input-group input-group-sm">
					<div class="input-group-prepend">
						<span class="input-group-text">$</span>
					</div>
					<input id="precio-gas" type="number" class="form-control">
					<div class="input-group-append">
						<span class="input-group-text">MXN/L</span>
					</div>
				</div>

				<button id="calc-precio-gas" class="btn btn-success btn-sm">Calcular</button>

				<table id="tabla" class="table table-bordered table-sm" style="display: none;">
					<tbody>
						<tr>
							<th></th>
							<th>Consumo (L)</th>
							<th>Precio (MXN)</th>
						</tr>
						<tr>
							<td id="distanciatd"></td>
							<td id="gasolinadist"></td>
							<td id="preciodist"></td>
						</tr>
						<tr>
							<td>1 Km</td>
							<td id="gasolina1km"></td>
							<td id="precio1km"></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

	</section>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.js"></script>
	<script type="text/javascript">
		$(function() {
			let conversion = 'USD_MXN',
				precio_moneda_base = 0;

			$.ajax({
				url: 'https://free.currencyconverterapi.com/api/v6/convert',
				method: 'GET',
				data: {
					q: conversion,
					compact: 'ultra',
					apiKey: 'f3abfcace10f17849340'
				}
			}).done(data => {
				console.log(data[conversion]);
				precio_moneda_base = data[conversion];
				$('#moneda_de, #moneda_a').prop('disabled', false);

				$('#moneda_de').on('keyup change', function() {
					let moneda_de = parseFloat($(this).val());
					let moneda_a = moneda_de * precio_moneda_base;
					$('#moneda_a').val(moneda_a.toFixed(2));
				});
				$('#moneda_a').on('keyup change', function() {
					let mondeda_de = parseFloat($(this).val());
					let moneda_a = mondeda_de / precio_moneda_base;
					$('#moneda_de').val(moneda_a.toFixed(2));
				});

				$('#moneda').show();
			}).fail(jqXHR => {
				console.log(JSON.stringify(jqXHR, null, 4));
			});

			$('#millas').on('keyup change', function() {
				let millas = parseFloat($(this).val());
				let kilometros = millas * 1.60934;
				$('#kilometros').val(kilometros.toFixed(2));
			});
			$('#kilometros').on('keyup change', function() {
				let kilometros = parseFloat($(this).val());
				let millas = kilometros / 1.60934;
				$('#millas').val(millas.toFixed(2));
			});

			$('#galones').on('keyup change', function() {
				let galones = parseFloat($(this).val());
				let litros = galones * 3.785412;
				$('#litros').val(litros.toFixed(2));
			});
			$('#litros').on('keyup change', function() {
				let litros = parseFloat($(this).val());
				let galones = litros / 3.785412;
				$('#galones').val(galones.toFixed(2));
			});

			$('#kml-info').on('click', function() {
				$('#kml-modal').modal();
			});

			$('#calc-kml').on('click', function() {
				let kma = parseFloat($('#kma').val()),
					kmb = parseFloat($('#kmb').val()),
					litros = parseFloat($('#litros-tanque').val()),
					kml = (kmb - kma) / litros;

				if(kml) $('#kml-res').text(kml.toFixed(2) + ' Km/L').show();
			});

			$('#calc-precio-gas').on('click', function() {

				let distancia = parseFloat($('#distancia').val()),
					regreso_checked = $('#regreso').is(':checked'),
					rendimiento = parseFloat($('#rendimiento').val()),
					unidad_rendimiento = parseInt($('#unidad option:selected').val()),
					precio_gas = parseFloat($('#precio-gas').val());

				if(!distancia) {
					alert('Cuanto va recorrer?');
					return null;
				} else if(!rendimiento) {
					alert('Cuanta gasolina gasta su carro?');
					return null;
				} else {

					if(regreso_checked) {
						distancia = distancia * 2;
					}

					if(unidad_rendimiento === 2) { // km/l
						rendimiento = 100 / rendimiento;
					}

					let gasolinadist = (distancia / 100) * rendimiento;
					let gasolina1km = rendimiento / 100;

					let preciodist = gasolinadist * precio_gas;
					let precio1km = gasolina1km * precio_gas;

					$('#distanciatd').text(distancia + ' Km');
					$('#gasolinadist').text(gasolinadist.toFixed(2));
					$('#gasolina1km').text(gasolina1km.toFixed(2));

					if(precio_gas) {
						$('#preciodist').text('$' + preciodist.toFixed(2));
						$('#precio1km').text('$' + precio1km.toFixed(2));
					} else {
						$('#preciodist, #precio1km').text('');
					}

					$('#tabla').show();
				}
			});
		});
	</script>
</body>

</html>